<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-04-07 Mon 00:29 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Setting Up Emacs as a Python IDE with Eglot, Pyright, Black, and Ruff</title>
<meta name="author" content="sbilmis" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="../org-html-themes/src/readtheorg_theme/css/rtd-full.css" />
                   <link rel="stylesheet" type="text/css" href="../org-html-themes/src/readtheorg_theme/css/readtheorg.css" />
                   <link rel="stylesheet" type="text/css" href="../org-html-themes/src/readtheorg_theme/css/htmlize.css" />
                   <link rel="stylesheet" type="text/css" href="../org-html-themes/src/readtheorg_theme/css/search.css" />
                   <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
                   <script type="text/javascript" src="../org-html-themes/src/readtheorg_theme/js/readtheorg.js"></script>
                   <script type="text/javascript" src="../org-html-themes/src/readtheorg_theme/js/search.js"></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Setting Up Emacs as a Python IDE with Eglot, Pyright, Black, and Ruff</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org7d7944f">1. Introduction</a></li>
<li><a href="#orge30b20a">2. Prerequisites</a></li>
<li><a href="#org8b9b661">3. Setting Up Emacs as a Python IDE with Eglot, Pyright, Black, and Ruff</a>
<ul>
<li><a href="#org2da6727">3.1. References</a></li>
</ul>
</li>
<li><a href="#orgb09765a">4. Creating a Python Virtual Environment with pyenv</a>
<ul>
<li><a href="#orgb5868d2">4.1. Why use pyenv?</a></li>
<li><a href="#orgb6bff88">4.2. Step 1: Install `pyenv` and `pyenv-virtualenv`</a></li>
<li><a href="#orga787445">4.3. Step 2: Install Python and Create a Virtual Environment</a></li>
<li><a href="#org7d49132">4.4. Step 3: Link the Virtual Environment to Your Project</a></li>
<li><a href="#org0cc9209">4.5. Step 4: Install Python Development Tools</a></li>
<li><a href="#orgb73f711">4.6. Installing Packages from a `requirements.txt`</a></li>
<li><a href="#org2e6a25c">4.7. Step 5: Confirm the Installation Locations</a></li>
<li><a href="#org881bace">4.8. Next Step: Configure Emacs for Python Development</a></li>
</ul>
</li>
<li><a href="#orgeade3fc">5. Emacs Configuration for Python with Eglot, Black, and Ruff</a>
<ul>
<li><a href="#orgdba94a0">5.1. Step 1: Make pyenv available to Emacs</a></li>
<li><a href="#orgd5f8d79">5.2. Step 2: Auto-activate pyenv virtualenvs per project</a></li>
<li><a href="#org3b1e941">5.3. Step 3: Install and configure Emacs packages</a></li>
<li><a href="#org215218c">5.4. Step 4: How to test that everything works</a>
<ul>
<li><a href="#org6cbd74b">5.4.1. ‚úÖ Pyvenv</a></li>
<li><a href="#orgb244625">5.4.2. ‚úÖ Eglot + Pyright</a></li>
<li><a href="#org6ff7158">5.4.3. ‚úÖ Black Formatter</a></li>
<li><a href="#org9f38238">5.4.4. ‚úÖ Ruff Linter via Flycheck</a></li>
<li><a href="#org0aac8b2">5.4.5. ‚úÖ Flycheck Setup</a></li>
</ul>
</li>
<li><a href="#org0aaea9f">5.5. Optional: Manual Environment Activation</a></li>
</ul>
</li>
<li><a href="#org069d3af">6. Commonly Used Eglot Features for Python Environment</a>
<ul>
<li><a href="#org6447e1e">6.1. Navigation and Editing</a></li>
<li><a href="#org3375758">6.2. Documentation and Feedback</a></li>
<li><a href="#org7bb68ea">6.3. Optional: Completion with Corfu</a></li>
<li><a href="#org44b22e8">6.4. Coming Next: Code Formatting and Linting with Black and Ruff</a></li>
</ul>
</li>
<li><a href="#orge90335c">7. Black and Ruff: Code Formatting and Linting</a>
<ul>
<li><a href="#org20101ee">7.1. Black: Automatic Code Formatter</a>
<ul>
<li><a href="#org4723e63">7.1.1. Why use Black?</a></li>
<li><a href="#org512f4f7">7.1.2. Example</a></li>
</ul>
</li>
<li><a href="#orgeb96e07">7.2. Ruff: Python Linter and Code Fixer</a>
<ul>
<li><a href="#org61d25d3">7.2.1. Why use Ruff?</a></li>
<li><a href="#orgb7e111c">7.2.2. Example</a></li>
<li><a href="#org3e1a9e7">7.2.3. Additional Ruff Commands</a></li>
<li><a href="#org573ff2b">7.2.4. Emacs Integration via Flycheck</a></li>
</ul>
</li>
<li><a href="#org688868b">7.3. Summary</a></li>
<li><a href="#org901a430">7.4. ‚úÖ Is Eglot Connected to Pyright?</a></li>
<li><a href="#orgc5ba205">7.5. ‚úÖ Is Black Working?</a></li>
<li><a href="#orgaea7163">7.6. ‚úÖ Is Ruff Working (Linting)?</a></li>
<li><a href="#org2a2b6db">7.7. üîç Minimal Debug File to Test Everything</a></li>
<li><a href="#org1af27e2">7.8. üîß Still Not Working?</a></li>
</ul>
</li>
<li><a href="#org2ebfc92">8. Final Thoughts and Tips</a>
<ul>
<li><a href="#org7dfea4b">8.1. Tips for Daily Use</a></li>
<li><a href="#orgc20d9bf">8.2. Resources</a></li>
<li><a href="#org19c2d76">8.3. Acknowledgements</a></li>
</ul>
</li>
<li><a href="#org1df14b8">9. Cheatsheet: Common Python IDE Commands in Emacs</a></li>
<li><a href="#orgcd99747">10. Practice Session: Test Your Emacs Python IDE</a>
<ul>
<li><a href="#orgae74458">10.1. Goal</a></li>
<li><a href="#orge33b382">10.2. Step 1: Create a Virtualenv</a></li>
<li><a href="#orgb6122ee">10.3. Step 2: Open the Project in Emacs</a></li>
<li><a href="#org716c266">10.4. Step 3: Write a Test Script</a></li>
<li><a href="#orgf9ac51e">10.5. Step 4: Test Eglot (LSP Features)</a></li>
<li><a href="#org7e455d3">10.6. Step 5: Test Black (Formatting)</a></li>
<li><a href="#org65a5597">10.7. Step 6: Test Ruff (Linting)</a></li>
<li><a href="#org9b49e95">10.8. Step 7: Fix the Issues</a></li>
<li><a href="#org712110e">10.9. Bonus: Test Completions</a></li>
<li><a href="#org567de9b">10.10. Expected Workflow Summary</a></li>
<li><a href="#org8fd9619">10.11. Troubleshooting</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-org7d7944f" class="outline-2">
<h2 id="org7d7944f"><span class="section-number-2">1.</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
This tutorial will walk you through turning Emacs into a powerful, modern Python development environment ‚Äî complete with code intelligence, linting, and formatting ‚Äî using:
</p>

<ul class="org-ul">
<li>`eglot` (built-in LSP client)</li>
<li>`pyright` (fast Python language server)</li>
<li>`black` (automatic code formatter)</li>
<li>`ruff` (fast Python linter)</li>
<li>`pyenv` and `pyvenv` (for managing isolated Python environments)</li>
</ul>

<p>
By the end of this tutorial, you'll have a lightweight yet capable Emacs IDE suitable for daily Python and PyTorch development.
</p>

<p>
&#x2014;
</p>
</div>
</div>
<div id="outline-container-orge30b20a" class="outline-2">
<h2 id="orge30b20a"><span class="section-number-2">2.</span> Prerequisites</h2>
<div class="outline-text-2" id="text-2">
<p>
Before you begin, make sure you have:
</p>

<ul class="org-ul">
<li>‚úÖ Emacs 29 or higher (Eglot is built-in)</li>
<li>‚úÖ The MELPA package archive enabled</li>
<li>‚úÖ Basic familiarity with Emacs keybindings:
<ul class="org-ul">
<li><code>M-x</code> (run command)</li>
<li><code>C-x C-f</code> (open file)</li>
<li><code>M-:</code> (evaluate Elisp)</li>
</ul></li>
</ul>

<p>
If you‚Äôre completely new to Emacs, consider reviewing a short Emacs basics guide first.
</p>
</div>
</div>
<div id="outline-container-org8b9b661" class="outline-2">
<h2 id="org8b9b661"><span class="section-number-2">3.</span> Setting Up Emacs as a Python IDE with Eglot, Pyright, Black, and Ruff</h2>
<div class="outline-text-2" id="text-3">
<p>
The <b>Language Server Protocol (LSP)</b> is a way for editors like Emacs to communicate with language servers that understand a programming language in detail.
</p>

<p>
In this guide, we‚Äôll use <b><b>Eglot</b></b> (Emacs‚Äôs built-in LSP client) to connect to <b><b>Pyright</b></b>, a fast Python language server. This enables IDE-like features such as auto-completion, go-to-definition, and documentation lookup ‚Äî all from within Emacs.
</p>


<p>
<b><b>Emacs supports multiple LSP clients</b></b>, including:
</p>

<ul class="org-ul">
<li><code>lsp-mode</code> ‚Äì Feature-rich and customizable, but heavier and more complex.</li>
<li><code>lsp-bridge</code> ‚Äì A fast, asynchronous LSP client using Python.</li>
<li><code>company-jedi</code> ‚Äì A lightweight non-LSP completion backend (limited in functionality).</li>
</ul>

<p>
In this tutorial, we will use <b><b>Eglot</b></b> because:
</p>

<ul class="org-ul">
<li>‚úÖ It is <b>built into Emacs 29</b>, no additional installation needed.</li>
<li>‚úÖ It is <b>lightweight and minimal</b>, ideal for a smooth and fast workflow.</li>
<li>‚úÖ It provides <b>essential LSP features</b> without unnecessary complexity.</li>
</ul>

<p>
Each language requires its own LSP server. For Python, there are several options:
</p>

<ul class="org-ul">
<li><b><b>Pyright</b></b> (Recommended) ‚Äì Fast, lightweight, excellent for type checking.</li>
<li><b><b>Pylsp</b></b> ‚Äì Plugin-based and highly configurable, but slower.</li>
<li><b><b>Jedi Language Server</b></b> ‚Äì Minimal and lightweight, but lacks advanced type checking.</li>
<li><b><b>Microsoft Python Language Server</b></b> ‚Äì Deprecated and no longer maintained.</li>
</ul>

<p>
In this tutorial, we will use:
</p>
<ul class="org-ul">
<li><b><b>Eglot</b></b> as our LSP client,</li>
<li><b><b>Pyright</b></b> as the Python language server,</li>
<li><b><b>Black</b></b> for automatic code formatting,</li>
<li><b><b>Ruff</b></b> for linting and style checks.</li>
</ul>

<p>
<b>Black</b> is an opinionated Python code formatter that ensures a consistent code style. It will run automatically when saving a file.  
<b>Ruff</b> is a <b>fast</b> linter written in Rust that checks for errors, unused variables, and enforces good coding practices.
</p>


<p>
While both Black and Ruff modify code, they serve different purposes:  
</p>
<ul class="org-ul">
<li>Black reformats code to follow a consistent style.</li>
<li>Ruff identifies coding issues and enforces best practices, like unused imports or undefined variables.</li>
</ul>


<p>
Our goal is to set up an Emacs environment that makes Python and PyTorch development smooth, error-free, and efficient.
</p>

<p>
<b><b>Summary of Tools</b></b>
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Tool</th>
<th scope="col" class="org-left">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">`python-mode`</td>
<td class="org-left">Major mode for editing Python code in Emacs.</td>
</tr>

<tr>
<td class="org-left">`eglot`</td>
<td class="org-left">Built-in LSP client to enable features like auto-completion, navigation, and diagnostics via language servers.</td>
</tr>

<tr>
<td class="org-left">`pyright`</td>
<td class="org-left">A fast, feature-rich Python language server.</td>
</tr>

<tr>
<td class="org-left">`black`</td>
<td class="org-left">Automatically formats Python code to follow a consistent style (PEP 8).</td>
</tr>

<tr>
<td class="org-left">`ruff`</td>
<td class="org-left">A fast linter that checks for code issues and enforces style rules.</td>
</tr>
</tbody>
</table>
</div>
<div id="outline-container-org2da6727" class="outline-3">
<h3 id="org2da6727"><span class="section-number-3">3.1.</span> References</h3>
<div class="outline-text-3" id="text-3-1">
<ul class="org-ul">
<li><a href="https://microsoft.github.io/language-server-protocol/">Language Server Protocol (LSP)</a></li>
<li><a href="https://github.com/microsoft/pyright">Pyright</a></li>
<li><a href="https://black.readthedocs.io/">Black Formatter</a></li>
<li><a href="https://docs.astral.sh/ruff/">Ruff Linter</a></li>
</ul>


<p>
Each of these tools will enhance your Emacs environment for Python and PyTorch development.
</p>
</div>
</div>
</div>
<div id="outline-container-orgb09765a" class="outline-2">
<h2 id="orgb09765a"><span class="section-number-2">4.</span> Creating a Python Virtual Environment with pyenv</h2>
<div class="outline-text-2" id="text-4">
<p>
Python virtual environments allow you to create isolated environments for different projects. This means:
</p>

<ul class="org-ul">
<li>Each project can have its own version of Python and its own installed packages.</li>
<li>You avoid conflicts between different package versions across projects.</li>
<li>You can test code in a clean environment without affecting your system Python or other projects.</li>
</ul>

<p>
Using virtual environments is considered a best practice for Python development ‚Äî especially in long-term projects, collaborative environments, or when using IDEs like Emacs, VSCode, or PyCharm.
</p>

<div class="note" id="org697e7d7">
<p>
üí° <b>Alternative: Using Conda instead of pyenv</b>
</p>

<p>
If you're already using Anaconda or Miniconda, you can manage environments with:
</p>

<ul class="org-ul">
<li>`conda create -n myenv python=3.11`</li>
<li>`conda activate myenv`</li>
</ul>

<p>
Then, inside Emacs, activate the environment with:
</p>

<p>
M-x pyvenv-activate RET /path/to/conda/envs/myenv
</p>

<p>
You do <b>not</b> need `.python-version` in this case.
</p>

</div>
</div>
<div id="outline-container-orgb5868d2" class="outline-3">
<h3 id="orgb5868d2"><span class="section-number-3">4.1.</span> Why use pyenv?</h3>
<div class="outline-text-3" id="text-4-1">
<p>
`pyenv` is a tool that helps manage multiple versions of Python. It also works well with `pyenv-virtualenv`, an extension that manages per-project virtual environments.
</p>

<p>
Advantages:
</p>

<ul class="org-ul">
<li>Install and switch between multiple Python versions easily.</li>
<li>Keep each project‚Äôs dependencies separate.</li>
<li>Automatically activate environments based on project folders.</li>
</ul>

<p>
&#x2014;
</p>
</div>
</div>
<div id="outline-container-orgb6bff88" class="outline-3">
<h3 id="orgb6bff88"><span class="section-number-3">4.2.</span> Step 1: Install `pyenv` and `pyenv-virtualenv`</h3>
<div class="outline-text-3" id="text-4-2">
<p>
On macOS, use Homebrew to install:
</p>

<div class="org-src-container">
<pre class="src src-shell">brew install pyenv
brew install pyenv-virtualenv
</pre>
</div>

<p>
Check that pyenv is available by running:
</p>

<div class="org-src-container">
<pre class="src src-shell">pyenv --version
</pre>
</div>

<p>
To make sure it works inside your terminal and Emacs, add this to your shell config file (`~/.bashrc`, or similar):
</p>

<div class="org-src-container">
<pre class="src src-shell">export PYENV_ROOT="$HOME/.pyenv"
export PATH="$PYENV_ROOT/bin:$PATH"
eval "$(pyenv init --path)"
eval "$(pyenv virtualenv-init -)"
</pre>
</div>

<p>
Then reload your shell:
</p>

<div class="org-src-container">
<pre class="src src-shell">source ~/.bashrc
</pre>
</div>

<p>
&#x2014;
</p>
</div>
</div>
<div id="outline-container-orga787445" class="outline-3">
<h3 id="orga787445"><span class="section-number-3">4.3.</span> Step 2: Install Python and Create a Virtual Environment</h3>
<div class="outline-text-3" id="text-4-3">
<p>
Once pyenv is set up, you can install a specific version of Python:
</p>

<div class="org-src-container">
<pre class="src src-shell">pyenv install --list                 # List all available Python versions
pyenv install 3.11.6                 # Install the version if not present
</pre>
</div>

<p>
Now create a virtual environment using `pyenv-virtualenv`:
</p>

<div class="org-src-container">
<pre class="src src-shell">pyenv virtualenv 3.11.6 myenv_name  # Create virtualenv named myenv_name
pyenv virtualenvs                   # List all existing virtualenvs
</pre>
</div>

<p>
This will create a new virtual environment located at:
</p>

<p>
~/Users/&lt;username&gt;/.pyenv/versions/myenv<sub>name</sub>/
</p>

<p>
&#x2014;
</p>
</div>
</div>
<div id="outline-container-org7d49132" class="outline-3">
<h3 id="org7d49132"><span class="section-number-3">4.4.</span> Step 3: Link the Virtual Environment to Your Project</h3>
<div class="outline-text-3" id="text-4-4">
<p>
Navigate to your project folder and associate it with the virtualenv:
</p>

<div class="org-src-container">
<pre class="src src-shell">cd ~/myproject
pyenv local myenv_name
</pre>
</div>

<p>
This creates a `.python-version` file in your project directory. Tools like Emacs and shell terminals will detect this file and automatically activate the right Python environment for you.
</p>

<div class="note" id="org101c20d">
<p>
üí° `pyenv local` enables <b>persistent</b> activation for the folder, making it ideal for development tools like Emacs or VSCode.
</p>

<p>
üí° `pyenv activate myenv<sub>name</sub>` only activates it for your current shell session. It is useful for quick tests or temporary use.
</p>

</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Command</th>
<th scope="col" class="org-left">Scope</th>
<th scope="col" class="org-left">Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">pyenv activate</td>
<td class="org-left">Temporary</td>
<td class="org-left">Manual activation for current shell</td>
</tr>

<tr>
<td class="org-left">pyenv local</td>
<td class="org-left">Persistent</td>
<td class="org-left">Automatic activation per project</td>
</tr>
</tbody>
</table>

<p>
&#x2014;
</p>
</div>
</div>
<div id="outline-container-org0cc9209" class="outline-3">
<h3 id="org0cc9209"><span class="section-number-3">4.5.</span> Step 4: Install Python Development Tools</h3>
<div class="outline-text-3" id="text-4-5">
<p>
While inside the virtualenv, install the following Python tools:
</p>

<div class="org-src-container">
<pre class="src src-shell">pip install black ruff pyright
</pre>
</div>

<ul class="org-ul">
<li>`black`: Formats code automatically to follow standard style rules.</li>
<li>`ruff`: Lints code for common errors and enforces best practices (fast and powerful).</li>
<li>`pyright`: Language server that provides type checking, completion, and diagnostics.</li>
</ul>
</div>
</div>
<div id="outline-container-orgb73f711" class="outline-3">
<h3 id="orgb73f711"><span class="section-number-3">4.6.</span> Installing Packages from a `requirements.txt`</h3>
<div class="outline-text-3" id="text-4-6">
<p>
Instead of manually installing packages, you can also manage dependencies with a `requirements.txt` file.
</p>

<p>
To install:
</p>

<div class="org-src-container">
<pre class="src src-shell">pip install -r requirements.txt
</pre>
</div>

<p>
To generate it from your current environment:
</p>

<div class="org-src-container">
<pre class="src src-shell">pip freeze &gt; requirements.txt
</pre>
</div>

<p>
This is especially helpful for sharing your environment with collaborators or re-creating it later.
</p>

<div class="note" id="org4ed7dff">
<p>
üí° <b>Advanced: Dependency Management with pip-tools or Poetry</b>
</p>

<p>
If you're working on a larger or collaborative project, consider using:
</p>

<ul class="org-ul">
<li><p>
<a href="https://github.com/jazzband/pip-tools">pip-tools</a>: Keeps your `requirements.txt` clean and pinned.  
Write your top-level dependencies in `requirements.in` and run:
</p>

<div class="org-src-container">
<pre class="src src-shell">pip-compile requirements.in
</pre>
</div>

<p>
It will generate a full `requirements.txt` with exact versions.
</p></li>

<li><a href="https://python-poetry.org">Poetry</a>: A full-featured project/dependency manager using `pyproject.toml`.  
It also handles virtual environments and packaging.</li>
</ul>

<p>
Both tools work with Emacs and `pyvenv`. If you use Poetry, activate its virtualenv manually with:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">M-x pyvenv-activate RET /Users/you/Library/Caches/pypoetry/virtualenvs/myenv
</pre>
</div>

</div>


<p>
&#x2014;
</p>
</div>
</div>
<div id="outline-container-org2e6a25c" class="outline-3">
<h3 id="org2e6a25c"><span class="section-number-3">4.7.</span> Step 5: Confirm the Installation Locations</h3>
<div class="outline-text-3" id="text-4-7">
<div class="note" id="orgfe5772b">
<p>
Your virtualenv and tools are stored in:
</p>

<ul class="org-ul">
<li>Virtualenv: <code>~/Users/&lt;username&gt;/.pyenv/versions/myenv_name/</code></li>
<li>Tools (black, ruff, etc.): <code>~/Users/&lt;username&gt;/.pyenv/versions/myenv_name/bin/</code></li>
</ul>

</div>

<p>
This structure keeps your global system clean while giving you a per-project setup.
</p>

<p>
&#x2014;
</p>
</div>
</div>
<div id="outline-container-org881bace" class="outline-3">
<h3 id="org881bace"><span class="section-number-3">4.8.</span> Next Step: Configure Emacs for Python Development</h3>
<div class="outline-text-3" id="text-4-8">
<p>
With your Python environment ready, it's time to connect Emacs to this setup.
</p>

<p>
We‚Äôll configure:
</p>

<ul class="org-ul">
<li>Automatic virtual environment activation in Emacs</li>
<li>Eglot as the LSP client</li>
<li>Black as the auto-formatter</li>
<li>Ruff + Flycheck for linting</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgeade3fc" class="outline-2">
<h2 id="orgeade3fc"><span class="section-number-2">5.</span> Emacs Configuration for Python with Eglot, Black, and Ruff</h2>
<div class="outline-text-2" id="text-5">
<p>
Now that your virtual environment is ready, let‚Äôs configure Emacs to:
</p>

<ul class="org-ul">
<li>Automatically activate the correct Python environment</li>
<li>Connect to the Pyright language server via Eglot</li>
<li>Format code with Black on save</li>
<li>Lint code using Ruff via Flycheck</li>
</ul>

<p>
We will use the following Emacs packages:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Package</th>
<th scope="col" class="org-left">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">`python-mode`</td>
<td class="org-left">Major mode for Python editing</td>
</tr>

<tr>
<td class="org-left">`pyvenv`</td>
<td class="org-left">Interface for managing virtualenvs in Emacs</td>
</tr>

<tr>
<td class="org-left">`eglot`</td>
<td class="org-left">Built-in LSP client in Emacs (connects to Pyright)</td>
</tr>

<tr>
<td class="org-left">`python-black`</td>
<td class="org-left">Formats code automatically using Black on save</td>
</tr>

<tr>
<td class="org-left">`flycheck`</td>
<td class="org-left">On-the-fly syntax checking with Ruff integration</td>
</tr>
</tbody>
</table>

<p>
&#x2014;
</p>
</div>
<div id="outline-container-orgdba94a0" class="outline-3">
<h3 id="orgdba94a0"><span class="section-number-3">5.1.</span> Step 1: Make pyenv available to Emacs</h3>
<div class="outline-text-3" id="text-5-1">
<p>
If you installed pyenv using Homebrew on macOS, you must ensure that Emacs sees `/opt/homebrew/bin`.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">;; Add pyenv path to Emacs environment
(setenv "PATH" (concat "/opt/homebrew/bin:" (getenv "PATH")))
(add-to-list 'exec-path "/opt/homebrew/bin")
</pre>
</div>

<p>
&#x2014;
</p>
</div>
</div>
<div id="outline-container-orgd5f8d79" class="outline-3">
<h3 id="orgd5f8d79"><span class="section-number-3">5.2.</span> Step 2: Auto-activate pyenv virtualenvs per project</h3>
<div class="outline-text-3" id="text-5-2">
<p>
This function looks for a `.python-version` file and automatically activates the correct pyenv environment when you open a Python file.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun my/pyenv-auto-activate ()
  "Auto-activate pyenv virtualenv from .python-version file."
  (let* ((root (locate-dominating-file default-directory ".python-version"))
         (pyenv-file (when root (expand-file-name ".python-version" root))))
    (when (and pyenv-file (file-exists-p pyenv-file))
      (let ((env-name (string-trim (with-temp-buffer
                                     (insert-file-contents pyenv-file)
                                     (buffer-string)))))
        (let ((full-path (expand-file-name env-name
                                           (expand-file-name "versions" (getenv "PYENV_ROOT")))))
          (when (file-directory-p full-path)
            (pyvenv-activate full-path)))))))

(add-hook 'python-mode-hook #'my/pyenv-auto-activate)
</pre>
</div>

<p>
This will auto-activate your environment as long as your project contains a `.python-version` file created via `pyenv local &lt;env&gt;`.
</p>

<p>
&#x2014;
</p>
</div>
</div>
<div id="outline-container-org3b1e941" class="outline-3">
<h3 id="org3b1e941"><span class="section-number-3">5.3.</span> Step 3: Install and configure Emacs packages</h3>
<div class="outline-text-3" id="text-5-3">
<p>
Make sure you have the following packages installed via `M-x package-install` or using `use-package`.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">;; Python editing support
(use-package python
  :ensure t
  :mode ("\\.py\\'" . python-mode))

;; Virtualenv support
(use-package pyvenv
  :ensure t
  :config
  (pyvenv-mode 1)
  :hook (python-mode . pyvenv-tracking-mode))

;; LSP client: Eglot + Pyright
(use-package eglot
  :ensure t
  :hook (python-mode . eglot-ensure)
  :config
  (add-to-list 'eglot-server-programs
               '(python-mode . ("pyright-langserver" "--stdio"))))

;; Auto-format code using Black
(use-package python-black
  :ensure t
  :after python
  :hook (python-mode . python-black-on-save-mode))

;; Real-time linting using Flycheck and Ruff
(use-package flycheck
  :ensure t
  :hook (python-mode . flycheck-mode))
</pre>
</div>

<p>
&#x2014;
</p>
</div>
</div>
<div id="outline-container-org215218c" class="outline-3">
<h3 id="org215218c"><span class="section-number-3">5.4.</span> Step 4: How to test that everything works</h3>
<div class="outline-text-3" id="text-5-4">
<p>
Open a `.py` file inside your project folder (which has a `.python-version` file), and check the following:
</p>
</div>
<div id="outline-container-org6cbd74b" class="outline-4">
<h4 id="org6cbd74b"><span class="section-number-4">5.4.1.</span> ‚úÖ Pyvenv</h4>
<div class="outline-text-4" id="text-5-4-1">
<ul class="org-ul">
<li>Emacs should automatically activate the virtualenv.</li>
<li><p>
Confirm with:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">M-: pyvenv-virtual-env
</pre>
</div></li>
<li>‚úîÔ∏è Should return the path of your pyenv-managed environment.</li>
</ul>
</div>
</div>
<div id="outline-container-orgb244625" class="outline-4">
<h4 id="orgb244625"><span class="section-number-4">5.4.2.</span> ‚úÖ Eglot + Pyright</h4>
<div class="outline-text-4" id="text-5-4-2">
<ul class="org-ul">
<li>You should see: <b>"Connected to pyright!"</b> in the minibuffer.</li>
<li>Try:
<ul class="org-ul">
<li><code>M-.</code> ‚Üí Jump to definition</li>
<li><code>M-x eglot-code-actions</code> ‚Üí Organize imports or fix issues</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org6ff7158" class="outline-4">
<h4 id="org6ff7158"><span class="section-number-4">5.4.3.</span> ‚úÖ Black Formatter</h4>
<div class="outline-text-4" id="text-5-4-3">
<ul class="org-ul">
<li>Add some poorly formatted Python code.</li>
<li>Save the buffer.</li>
<li>‚úîÔ∏è It should be automatically reformatted.</li>
</ul>
</div>
</div>
<div id="outline-container-org9f38238" class="outline-4">
<h4 id="org9f38238"><span class="section-number-4">5.4.4.</span> ‚úÖ Ruff Linter via Flycheck</h4>
<div class="outline-text-4" id="text-5-4-4">
<ul class="org-ul">
<li>Add a line like <code>import os</code> without using it.</li>
<li><p>
Run:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">M-x flycheck-list-errors
</pre>
</div></li>
<li>‚úîÔ∏è Should report a linting warning.</li>
</ul>
</div>
</div>
<div id="outline-container-org0aac8b2" class="outline-4">
<h4 id="org0aac8b2"><span class="section-number-4">5.4.5.</span> ‚úÖ Flycheck Setup</h4>
<div class="outline-text-4" id="text-5-4-5">
<ul class="org-ul">
<li><p>
Run:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">M-x flycheck-verify-setup
</pre>
</div></li>
<li>‚úîÔ∏è `python-ruff` should be listed as an active checker.</li>
</ul>

<p>
&#x2014;
</p>
</div>
</div>
</div>
<div id="outline-container-org0aaea9f" class="outline-3">
<h3 id="org0aaea9f"><span class="section-number-3">5.5.</span> Optional: Manual Environment Activation</h3>
<div class="outline-text-3" id="text-5-5">
<p>
If you want to manually activate a pyenv virtualenv in Emacs:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">M-x pyvenv-activate
/Users/&lt;username&gt;/.pyenv/versions/myenv_name
</pre>
</div>

<p>
&#x2014;
</p>

<p>
The next section will cover:
</p>
</div>
</div>
</div>
<div id="outline-container-org069d3af" class="outline-2">
<h2 id="org069d3af"><span class="section-number-2">6.</span> Commonly Used Eglot Features for Python Environment</h2>
<div class="outline-text-2" id="text-6">
<p>
Once Eglot is enabled in a Python buffer, you'll see this in the minibuffer:
</p>

<p>
üì° <b>Connected to pyright!</b>
</p>

<p>
This means Emacs is now talking to the Pyright language server via the LSP protocol. You now have access to rich features like code navigation, refactoring, formatting, and more ‚Äî just like in a full-featured IDE.
</p>

<p>
Eglot integrates seamlessly with other Emacs tools like `eldoc`, `flymake`, and `completion-at-point`, making it both lightweight and powerful.
</p>

<p>
&#x2014;
</p>
</div>
<div id="outline-container-org6447e1e" class="outline-3">
<h3 id="org6447e1e"><span class="section-number-3">6.1.</span> Navigation and Editing</h3>
<div class="outline-text-3" id="text-6-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Action</th>
<th scope="col" class="org-left">Command / Keybinding</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Go to Definition</td>
<td class="org-left">`M-.`</td>
<td class="org-left">Jump to where a function, class, or variable is defined</td>
</tr>

<tr>
<td class="org-left">Find References</td>
<td class="org-left">`M-?`</td>
<td class="org-left">List all places the symbol is used in the project</td>
</tr>

<tr>
<td class="org-left">Rename Symbol</td>
<td class="org-left">`M-x eglot-rename`</td>
<td class="org-left">Rename the symbol under cursor across the project</td>
</tr>

<tr>
<td class="org-left">Code Actions</td>
<td class="org-left">`M-x eglot-code-actions`</td>
<td class="org-left">Show refactorings and quick fixes (like import suggestions)</td>
</tr>
</tbody>
</table>

<p>
üí° <b>Tip</b>: These features work best when your virtual environment is active and your buffer is saved.
</p>

<p>
&#x2014;
</p>
</div>
</div>
<div id="outline-container-org3375758" class="outline-3">
<h3 id="org3375758"><span class="section-number-3">6.2.</span> Documentation and Feedback</h3>
<div class="outline-text-3" id="text-6-2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Feature</th>
<th scope="col" class="org-left">Command / Behavior</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Hover Documentation</td>
<td class="org-left">Move cursor over symbol</td>
<td class="org-left">Shows function/type info in echo area (via `eldoc`)</td>
</tr>

<tr>
<td class="org-left">Show Diagnostics</td>
<td class="org-left">`M-x flymake-show-buffer-diagnostics`</td>
<td class="org-left">Show inline errors and warnings (from Pyright)</td>
</tr>

<tr>
<td class="org-left">Format Buffer</td>
<td class="org-left">`M-x eglot-format-buffer`</td>
<td class="org-left">Format entire buffer using the server's formatter</td>
</tr>
</tbody>
</table>

<ul class="org-ul">
<li>Diagnostics are powered by Flymake (built into Emacs).</li>
<li>Formatting works if the language server supports it (Pyright does not format ‚Äî we use Black instead).</li>
</ul>

<p>
&#x2014;
</p>
</div>
</div>
<div id="outline-container-org7bb68ea" class="outline-3">
<h3 id="org7bb68ea"><span class="section-number-3">6.3.</span> Optional: Completion with Corfu</h3>
<div class="outline-text-3" id="text-6-3">
<p>
While Emacs has built-in completion, the <b><b>Corfu</b></b> package offers a better UI for completions triggered by Eglot.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package corfu
  :ensure t
  :init
  (global-corfu-mode)
  :custom
  (corfu-auto t)                ;; Enable auto-completion
  (corfu-auto-delay 0.1)        ;; Delay before suggestions
  (corfu-auto-prefix 1)         ;; Trigger after 1 character
  (corfu-cycle t)               ;; Wrap around suggestions
  (corfu-echo-documentation t) ;; Show documentation popup
  :config
  (corfu-popupinfo-mode))      ;; Enable popup for docs (GUI only)
</pre>
</div>

<p>
To allow Corfu in the minibuffer (e.g., for `M-:` or `eval-expression`), add:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun my/corfu-enable-in-minibuffer ()
  "Enable Corfu in the minibuffer if appropriate."
  (when (where-is-internal #'completion-at-point (list (current-local-map)))
    (setq-local corfu-auto nil)
    (corfu-mode 1)))

(add-hook 'minibuffer-setup-hook #'my/corfu-enable-in-minibuffer)
</pre>
</div>

<p>
Corfu will now handle completions across your project smoothly, enhancing the experience without relying on external LSP UI tools.
</p>

<p>
&#x2014;
</p>
</div>
</div>
<div id="outline-container-org44b22e8" class="outline-3">
<h3 id="org44b22e8"><span class="section-number-3">6.4.</span> Coming Next: Code Formatting and Linting with Black and Ruff</h3>
<div class="outline-text-3" id="text-6-4">
<p>
You now have a fully functional LSP setup for Python in Emacs. In the next section, we‚Äôll focus on formatting and linting your code automatically using:
</p>

<ul class="org-ul">
<li>`black`: Python formatter</li>
<li>`ruff`: Fast linter with autofix support</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orge90335c" class="outline-2">
<h2 id="orge90335c"><span class="section-number-2">7.</span> Black and Ruff: Code Formatting and Linting</h2>
<div class="outline-text-2" id="text-7">
<p>
A great Python development setup doesn‚Äôt just work ‚Äî it also helps keep your code clean and consistent.
</p>

<p>
This is where <b><b>Black</b></b> (a code formatter) and <b><b>Ruff</b></b> (a linter) come in. Together, they enforce consistent code style, catch common mistakes, and help you write more readable and maintainable code.
</p>

<p>
&#x2014;
</p>
</div>
<div id="outline-container-org20101ee" class="outline-3">
<h3 id="org20101ee"><span class="section-number-3">7.1.</span> Black: Automatic Code Formatter</h3>
<div class="outline-text-3" id="text-7-1">
<p>
Black is a <b><b>highly opinionated code formatter</b></b> for Python. It reformats your code automatically to follow consistent style rules.
</p>
</div>
<div id="outline-container-org4723e63" class="outline-4">
<h4 id="org4723e63"><span class="section-number-4">7.1.1.</span> Why use Black?</h4>
<div class="outline-text-4" id="text-7-1-1">
<ul class="org-ul">
<li>üßº Automatically enforces a uniform code style.</li>
<li>üß† Removes debates about formatting choices.</li>
<li>üß© Ensures <b><b>PEP 8</b></b> compliance.</li>
<li>üíæ Runs every time you save a file (in our Emacs setup).</li>
</ul>
</div>
</div>
<div id="outline-container-org512f4f7" class="outline-4">
<h4 id="org512f4f7"><span class="section-number-4">7.1.2.</span> Example</h4>
<div class="outline-text-4" id="text-7-1-2">
<ul class="org-ul">
<li><p>
Before formatting:
</p>
<div class="org-src-container">
<pre class="src src-python">def my_function(x,y): return x+  y
</pre>
</div></li>

<li><p>
After running Black:
</p>
<div class="org-src-container">
<pre class="src src-python">def my_function(x, y):
    return x + y
</pre>
</div></li>
</ul>

<p>
Black integrates with Emacs via the <code>python-black-on-save-mode</code>, so no manual steps are required ‚Äî just save the file!
</p>

<p>
&#x2014;
</p>
</div>
</div>
</div>
<div id="outline-container-orgeb96e07" class="outline-3">
<h3 id="orgeb96e07"><span class="section-number-3">7.2.</span> Ruff: Python Linter and Code Fixer</h3>
<div class="outline-text-3" id="text-7-2">
<p>
Ruff is a <b><b>blazing-fast linter and code fixer</b></b> written in Rust. Unlike traditional linters, it's fast enough to run on every keystroke ‚Äî but even once per save is plenty.
</p>
</div>
<div id="outline-container-org61d25d3" class="outline-4">
<h4 id="org61d25d3"><span class="section-number-4">7.2.1.</span> Why use Ruff?</h4>
<div class="outline-text-4" id="text-7-2-1">
<ul class="org-ul">
<li>üêç Catches <b><b>syntax errors</b></b>, <b><b>unused variables</b></b>, and <b><b>style issues</b></b>.</li>
<li>üöÄ <b><b>Much faster</b></b> than `flake8`, `pylint`, or `pycodestyle`.</li>
<li>üîß Can automatically fix many issues (`ruff &#x2013;fix` or via Emacs).</li>
</ul>
</div>
</div>
<div id="outline-container-orgb7e111c" class="outline-4">
<h4 id="orgb7e111c"><span class="section-number-4">7.2.2.</span> Example</h4>
<div class="outline-text-4" id="text-7-2-2">
<ul class="org-ul">
<li><p>
Problematic code:
</p>
<div class="org-src-container">
<pre class="src src-python">import numpy as np  # Unused import

x = 10  # Unused variable
print("Hello, World!")
</pre>
</div></li>

<li>Ruff detects:
test.py:1:1: F401 'numpy as np' imported but unused test.py:3:1: F841 local variable 'x' is assigned to but never used</li>
</ul>


<ul class="org-ul">
<li>You can fix these:</li>
<li>In the terminal: <code>ruff --fix test.py</code></li>
<li>In Emacs: <code>M-x eglot-code-actions</code> (choose Ruff‚Äôs autofix option)</li>
</ul>
</div>
</div>
<div id="outline-container-org3e1a9e7" class="outline-4">
<h4 id="org3e1a9e7"><span class="section-number-4">7.2.3.</span> Additional Ruff Commands</h4>
<div class="outline-text-4" id="text-7-2-3">
<p>
You can also run Ruff manually on the command line to lint or fix a file:
</p>

<div class="org-src-container">
<pre class="src src-shell">ruff check my_script.py        # Show issues
ruff check --fix my_script.py  # Auto-fix issues
</pre>
</div>
</div>
</div>
<div id="outline-container-org573ff2b" class="outline-4">
<h4 id="org573ff2b"><span class="section-number-4">7.2.4.</span> Emacs Integration via Flycheck</h4>
<div class="outline-text-4" id="text-7-2-4">
<p>
If you‚Äôve installed `flycheck` and `ruff`, Emacs will show linting issues inline as you type or save.
</p>

<p>
To view them:
</p>

<ul class="org-ul">
<li>Run: <code>M-x flycheck-list-errors</code></li>
<li>Hover over underlined code to view tooltips</li>
<li>Run: <code>M-x flycheck-verify-setup</code> to confirm `python-ruff` is active</li>
</ul>

<p>
You can also customize the behavior of Flycheck or integrate Ruff directly as a checker if needed.
</p>

<p>
&#x2014;
</p>
</div>
</div>
</div>
<div id="outline-container-org688868b" class="outline-3">
<h3 id="org688868b"><span class="section-number-3">7.3.</span> Summary</h3>
<div class="outline-text-3" id="text-7-3">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Tool</th>
<th scope="col" class="org-left">Purpose</th>
<th scope="col" class="org-left">Runs on Save?</th>
<th scope="col" class="org-left">Can Autofix?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Black</td>
<td class="org-left">Code formatting</td>
<td class="org-left">‚úÖ</td>
<td class="org-left">‚úÖ (auto)</td>
</tr>

<tr>
<td class="org-left">Ruff</td>
<td class="org-left">Linting &amp; fixes</td>
<td class="org-left">‚úÖ (via Flycheck)</td>
<td class="org-left">‚úÖ (via `&#x2013;fix` or code actions)</td>
</tr>
</tbody>
</table>

<p>
With <b><b>Black</b></b> and <b><b>Ruff</b></b> set up, your Emacs environment ensures your code is:
</p>

<ul class="org-ul">
<li>‚úÖ Clean</li>
<li>‚úÖ Well-formatted</li>
<li>‚úÖ Free of common mistakes</li>
</ul>



<p>
If it points to `/usr/bin/python`, your virtualenv is not active.
</p>

<p>
&#x2014;
</p>
</div>
</div>
<div id="outline-container-org901a430" class="outline-3">
<h3 id="org901a430"><span class="section-number-3">7.4.</span> ‚úÖ Is Eglot Connected to Pyright?</h3>
<div class="outline-text-3" id="text-7-4">
<p>
When you open a `.py` file, Eglot should automatically connect. Look for:
</p>

<p>
üì° <b>Connected to pyright!</b> in the minibuffer.
</p>

<p>
You can also manually check with:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">M-x eglot
</pre>
</div>

<p>
If Eglot fails to connect:
</p>

<ul class="org-ul">
<li>Check if `pyright` is installed in the virtualenv: `pip show pyright`</li>
<li>Try running `pyright` from the terminal to confirm it works</li>
<li>Restart Emacs</li>
</ul>

<p>
&#x2014;
</p>
</div>
</div>
<div id="outline-container-orgc5ba205" class="outline-3">
<h3 id="orgc5ba205"><span class="section-number-3">7.5.</span> ‚úÖ Is Black Working?</h3>
<div class="outline-text-3" id="text-7-5">
<p>
To test that Black is formatting on save:
</p>

<ol class="org-ol">
<li><p>
Paste badly formatted code into a Python file:
</p>

<div class="org-src-container">
<pre class="src src-python">def test(x,y): return x+ y
</pre>
</div></li>

<li>Save the buffer.</li>
<li><p>
‚úîÔ∏è Code should be auto-formatted like this:
</p>

<div class="org-src-container">
<pre class="src src-python">def test(x, y):
    return x + y
</pre>
</div></li>
</ol>

<p>
If it‚Äôs not formatting:
</p>

<ul class="org-ul">
<li><p>
Make sure `python-black-on-save-mode` is active:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">M-: (bound-and-true-p python-black-on-save-mode) RET
</pre>
</div></li>

<li>Check if Black is installed: `pip show black`</li>
</ul>

<p>
&#x2014;
</p>
</div>
</div>
<div id="outline-container-orgaea7163" class="outline-3">
<h3 id="orgaea7163"><span class="section-number-3">7.6.</span> ‚úÖ Is Ruff Working (Linting)?</h3>
<div class="outline-text-3" id="text-7-6">
<ol class="org-ol">
<li><p>
Add some code with obvious issues:
</p>
<div class="org-src-container">
<pre class="src src-python">import os  # unused

x = 10     # unused
</pre>
</div></li>

<li>Save the file.</li>
<li><p>
Run:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">M-x flycheck-list-errors
</pre>
</div></li>

<li>‚úîÔ∏è You should see warnings from `ruff`, e.g.:</li>
</ol>

<p>
test.py:1:1: F401 'os' imported but unused test.py:3:1: F841 local variable 'x' is assigned to but never used
</p>


<p>
Also verify your active checkers with:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">M-x flycheck-verify-setup
</pre>
</div>

<ul class="org-ul">
<li>‚úîÔ∏è You should see: `Checker: python-ruff`</li>
<li>‚ùå If not listed, ensure `ruff` is installed in the active environment</li>
</ul>

<p>
&#x2014;
</p>
</div>
</div>
<div id="outline-container-org2a2b6db" class="outline-3">
<h3 id="org2a2b6db"><span class="section-number-3">7.7.</span> üîç Minimal Debug File to Test Everything</h3>
<div class="outline-text-3" id="text-7-7">
<p>
Here is a small Python file you can paste into Emacs to test your setup:
</p>

<div class="org-src-container">
<pre class="src src-python"># test.py
import os  # unused import

def test(  x ,y): return x+y   # bad formatting and unused var

x = 5
</pre>
</div>

<p>
Save the file and verify that:
</p>

<ul class="org-ul">
<li>Black reformats it</li>
<li>Ruff shows diagnostics via Flycheck</li>
<li>Eglot connects and offers navigation / code actions</li>
</ul>

<p>
&#x2014;
</p>
</div>
</div>
<div id="outline-container-org1af27e2" class="outline-3">
<h3 id="org1af27e2"><span class="section-number-3">7.8.</span> üîß Still Not Working?</h3>
<div class="outline-text-3" id="text-7-8">
<ul class="org-ul">
<li>Try restarting Emacs and reopening the file.</li>
<li>Open `*Messages*` buffer (<code>C-h e</code>) to see any warnings.</li>
<li>Open `*EGLOT (project-name)*` buffer for LSP logs.</li>
<li>Run: `M-x describe-variable RET eglot-server-programs RET`</li>
<li>Check if `pyright` is available with `M-x shell-command RET pyright &#x2013;version`</li>
</ul>

<p>
&#x2014;
</p>

<p>
This section helps you systematically verify each component of your Emacs Python IDE setup.
</p>
</div>
</div>
</div>
<div id="outline-container-org2ebfc92" class="outline-2">
<h2 id="org2ebfc92"><span class="section-number-2">8.</span> Final Thoughts and Tips</h2>
<div class="outline-text-2" id="text-8">
<p>
You've now set up Emacs as a full-featured Python IDE using:
</p>

<ul class="org-ul">
<li>‚úÖ `eglot` for Language Server integration</li>
<li>‚úÖ `pyright` for intelligent code navigation and type checking</li>
<li>‚úÖ `black` for automatic code formatting</li>
<li>‚úÖ `ruff` for fast linting and code fixes</li>
<li>‚úÖ `pyenv` + `pyvenv` for per-project virtual environments</li>
<li>‚úÖ `corfu` for clean and modern completions</li>
<li>‚úÖ `flycheck` for real-time lint feedback</li>
</ul>

<p>
This setup strikes a balance between being <b>lightweight</b>, <b>modern</b>, and <b>completely customizable</b> ‚Äî all within Emacs!
</p>

<p>
&#x2014;
</p>
</div>
<div id="outline-container-org7dfea4b" class="outline-3">
<h3 id="org7dfea4b"><span class="section-number-3">8.1.</span> Tips for Daily Use</h3>
<div class="outline-text-3" id="text-8-1">
<ul class="org-ul">
<li>Always create a `.python-version` in each project to auto-activate the environment.</li>
<li>Run <code>M-x flycheck-verify-setup</code> occasionally to ensure the right checkers are active.</li>
<li>Use <code>M-x eglot-code-actions</code> regularly for auto-imports, refactors, and quick fixes.</li>
<li>Use <code>C-c C-f</code> (or bind it yourself) to quickly run <code>eglot-format-buffer</code> if needed.</li>
<li>Save often to trigger Black and Ruff integrations.</li>
</ul>

<p>
&#x2014;
</p>
</div>
</div>
<div id="outline-container-orgc20d9bf" class="outline-3">
<h3 id="orgc20d9bf"><span class="section-number-3">8.2.</span> Resources</h3>
<div class="outline-text-3" id="text-8-2">
<ul class="org-ul">
<li><a href="https://github.com/joaotavora/eglot">Eglot on GitHub</a></li>
<li><a href="https://github.com/microsoft/pyright">Pyright Language Server</a></li>
<li><a href="https://black.readthedocs.io">Black Formatter Docs</a></li>
<li><a href="https://docs.astral.sh/ruff">Ruff Linter Docs</a></li>
<li><a href="https://github.com/pyenv/pyenv">pyenv on GitHub</a></li>
</ul>

<p>
&#x2014;
</p>
</div>
</div>
<div id="outline-container-org19c2d76" class="outline-3">
<h3 id="org19c2d76"><span class="section-number-3">8.3.</span> Acknowledgements</h3>
<div class="outline-text-3" id="text-8-3">
<p>
This tutorial was created to provide a lightweight and efficient Python development environment inside Emacs, ideal for research, teaching, or professional software development.
</p>
</div>
</div>
</div>
<div id="outline-container-org1df14b8" class="outline-2">
<h2 id="org1df14b8"><span class="section-number-2">9.</span> Cheatsheet: Common Python IDE Commands in Emacs</h2>
<div class="outline-text-2" id="text-9">
<div class="tip" id="org53b2249">
<p>
üìå Tip: You can print this cheatsheet or keep it in a split buffer (<code>C-x 3</code>) while working on your Python project. That way, you can quickly refer to keybindings without leaving Emacs.
</p>

</div>


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Action</th>
<th scope="col" class="org-left">Emacs Keybinding / Command</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Jump to definition</td>
<td class="org-left">M-.</td>
</tr>

<tr>
<td class="org-left">Find references</td>
<td class="org-left">M-?</td>
</tr>

<tr>
<td class="org-left">Rename symbol</td>
<td class="org-left">M-x eglot-rename</td>
</tr>

<tr>
<td class="org-left">Code actions / fixes</td>
<td class="org-left">M-x eglot-code-actions</td>
</tr>

<tr>
<td class="org-left">Format buffer (Black)</td>
<td class="org-left">M-x eglot-format-buffer</td>
</tr>

<tr>
<td class="org-left">Show diagnostics (Ruff)</td>
<td class="org-left">M-x flycheck-list-errors</td>
</tr>

<tr>
<td class="org-left">Recheck checkers</td>
<td class="org-left">M-x flycheck-verify-setup</td>
</tr>

<tr>
<td class="org-left">Open terminal</td>
<td class="org-left">M-x shell or M-x vterm</td>
</tr>

<tr>
<td class="org-left">View active virtualenv</td>
<td class="org-left">M-: pyvenv-virtual-env</td>
</tr>

<tr>
<td class="org-left">Activate virtualenv manually</td>
<td class="org-left">M-x pyvenv-activate</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgcd99747" class="outline-2">
<h2 id="orgcd99747"><span class="section-number-2">10.</span> Practice Session: Test Your Emacs Python IDE</h2>
<div class="outline-text-2" id="text-10">
</div>
<div id="outline-container-orgae74458" class="outline-3">
<h3 id="orgae74458"><span class="section-number-3">10.1.</span> Goal</h3>
<div class="outline-text-3" id="text-10-1">
<p>
Verify that your setup works by:  
</p>
<ol class="org-ol">
<li>Creating a virtualenv.</li>
<li>Writing a "buggy" Python script.</li>
<li>Testing LSP (Eglot), formatting (Black), and linting (Ruff).</li>
</ol>
</div>
</div>
<div id="outline-container-orge33b382" class="outline-3">
<h3 id="orge33b382"><span class="section-number-3">10.2.</span> Step 1: Create a Virtualenv</h3>
<div class="outline-text-3" id="text-10-2">
<p>
Run in terminal:  
</p>
<div class="org-src-container">
<pre class="src src-shell">cd ~/Desktop  # Or your preferred directory
mkdir emacs_python_test &amp;&amp; cd emacs_python_test
pyenv virtualenv 3.11.6 emacs_test_env  # Replace 3.11.6 with your Python version
pyenv local emacs_test_env
pip install pyright black ruff numpy    # Install tools + a demo package (e.g., numpy)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb6122ee" class="outline-3">
<h3 id="orgb6122ee"><span class="section-number-3">10.3.</span> Step 2: Open the Project in Emacs</h3>
<div class="outline-text-3" id="text-10-3">
<ul class="org-ul">
<li><p>
Run:  
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">M-x find-file RET ~/Desktop/emacs_python_test RET
</pre>
</div></li>
<li><p>
Confirm the virtualenv is active:  
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">M-: (message (pyvenv-virtual-env))  ; Should show the path to emacs_test_env
</pre>
</div></li>
</ul>
</div>
</div>
<div id="outline-container-org716c266" class="outline-3">
<h3 id="org716c266"><span class="section-number-3">10.4.</span> Step 3: Write a Test Script</h3>
<div class="outline-text-3" id="text-10-4">
<p>
Create a file named <code>test.py</code> with the following <b>intentionally problematic</b> code:  
</p>
<div class="org-src-container">
<pre class="src src-python">import os  # Unused import
import numpy as np  # Used later

def add(x,y): return x+y  # Bad formatting, no type hints

print(add(3, "5"))  # Type error (str + int)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf9ac51e" class="outline-3">
<h3 id="orgf9ac51e"><span class="section-number-3">10.5.</span> Step 4: Test Eglot (LSP Features)</h3>
<div class="outline-text-3" id="text-10-5">
<ol class="org-ol">
<li>Open <code>test.py</code> and wait for <code>Connected to pyright!</code> in the minibuffer.</li>
<li>Try these commands:  
<ul class="org-ul">
<li><code>M-.</code> on <code>np</code> ‚Üí Should jump to numpy‚Äôs source.</li>
<li><code>M-?</code> on <code>add</code> ‚Üí Should show no references (only one use).</li>
<li><code>M-x eglot-code-actions</code> ‚Üí Fix the type error (e.g., wrap `"5"` in `int()`).</li>
</ul></li>
</ol>
</div>
</div>
<div id="outline-container-org7e455d3" class="outline-3">
<h3 id="org7e455d3"><span class="section-number-3">10.6.</span> Step 5: Test Black (Formatting)</h3>
<div class="outline-text-3" id="text-10-6">
<ol class="org-ol">
<li>Save the file (<code>C-x C-s</code>).</li>
<li>Verify Black reformats the code to:</li>
</ol>
<div class="org-src-container">
<pre class="src src-python">import os  # Unused import
import numpy as np  # Used later


def add(x, y):
    return x + y  # Now properly formatted


print(add(3, "5"))  # Type error remains
</pre>
</div>
</div>
</div>
<div id="outline-container-org65a5597" class="outline-3">
<h3 id="org65a5597"><span class="section-number-3">10.7.</span> Step 6: Test Ruff (Linting)</h3>
<div class="outline-text-3" id="text-10-7">
<ol class="org-ol">
<li><p>
Run:  
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">M-x flycheck-list-errors
</pre>
</div></li>
<li>You should see:  
<ul class="org-ul">
<li><code>F401</code>: <code>os</code> is unused.</li>
<li><code>E712</code> (or similar): Type error in <code>add(3, "5")</code>.</li>
</ul></li>
</ol>
</div>
</div>
<div id="outline-container-org9b49e95" class="outline-3">
<h3 id="org9b49e95"><span class="section-number-3">10.8.</span> Step 7: Fix the Issues</h3>
<div class="outline-text-3" id="text-10-8">
<ol class="org-ol">
<li>Delete the unused <code>import os</code>.</li>
<li>Fix the type error (e.g., <code>print(add(3, int("5")))</code>).</li>
<li>Save again. Ruff and Black should now report no errors!</li>
</ol>
</div>
</div>
<div id="outline-container-org712110e" class="outline-3">
<h3 id="org712110e"><span class="section-number-3">10.9.</span> Bonus: Test Completions</h3>
<div class="outline-text-3" id="text-10-9">
<ol class="org-ol">
<li>Type <code>np.a</code> and wait for Corfu (or default Emacs completions) to suggest <code>np.array</code>.</li>
<li>Accept a suggestion with <code>TAB</code> or <code>RET</code>.</li>
</ol>
</div>
</div>
<div id="outline-container-org567de9b" class="outline-3">
<h3 id="org567de9b"><span class="section-number-3">10.10.</span> Expected Workflow Summary</h3>
<div class="outline-text-3" id="text-10-10">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Action</th>
<th scope="col" class="org-left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Open file</td>
<td class="org-left">Auto-activates virtualenv, Eglot connects</td>
</tr>

<tr>
<td class="org-left">Save file</td>
<td class="org-left">Black formats, Ruff lints</td>
</tr>

<tr>
<td class="org-left">Navigate (<code>M-.</code>)</td>
<td class="org-left">Jumps to definitions (e.g., numpy)</td>
</tr>

<tr>
<td class="org-left">Fix errors (<code>M-x eglot-code-actions</code>)</td>
<td class="org-left">Pyright suggests fixes</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org8fd9619" class="outline-3">
<h3 id="org8fd9619"><span class="section-number-3">10.11.</span> Troubleshooting</h3>
<div class="outline-text-3" id="text-10-11">
<ul class="org-ul">
<li>If something fails:  
<ol class="org-ol">
<li>Check <code>*Messages*</code> buffer (<code>C-h e</code>).</li>
<li>Run <code>M-x flycheck-verify-setup</code>.</li>
<li><p>
Confirm packages are in the virtualenv:  
</p>
<div class="org-src-container">
<pre class="src src-shell">pip list | grep -E "pyright|black|ruff"
</pre>
</div></li>
</ol></li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: sbilmis</p>
<p class="date">Created: 2025-04-07 Mon 00:29</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
