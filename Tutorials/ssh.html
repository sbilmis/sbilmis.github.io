<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2024-11-12 Tue 17:11 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SSH Tutorial</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="sbilmis" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<h1 class="title">SSH Tutorial</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org816375f">1. How to Log in to a Server via SSH Without Needing to Enter a Password</a>
<ul>
<li><a href="#org30f6505">1.1. Step 1: Generate an SSH Key Pair on Your Local Machine</a></li>
<li><a href="#orgfc69680">1.2. Step 2: Copy the Public Key to Your Server</a></li>
<li><a href="#org41454c9">1.3. Step 3: Log In Without a Password</a></li>
<li><a href="#org584194f">1.4. Step 4: Troubleshooting</a></li>
<li><a href="#org06ec2e1">1.5. Step 5: Using an SSH Agent for Managing Passphrases</a></li>
<li><a href="#org1f00cbf">1.6. Common SSH Commands</a></li>
</ul>
</li>
<li><a href="#orgf696ebe">2. Changing the SSH Key Password</a></li>
<li><a href="#org8d0ab62">3. Using SSH Agent to Manage Passphrase</a></li>
<li><a href="#org009847e">4. Automating SSH Key Setup for Multiple Servers Using sshpass</a></li>
<li><a href="#org4e9e0ec">5. Keeping SSH Sessions Alive</a></li>
</ul>
</div>
</div>


<div id="outline-container-org816375f" class="outline-2">
<h2 id="org816375f"><span class="section-number-2">1.</span> How to Log in to a Server via SSH Without Needing to Enter a Password</h2>
<div class="outline-text-2" id="text-1">
<p>
To set up passwordless SSH login, follow these steps to generate an SSH key pair and configure your server to recognize it. This allows you to connect to your server without entering a password every time.
</p>
</div>

<div id="outline-container-org30f6505" class="outline-3">
<h3 id="org30f6505"><span class="section-number-3">1.1.</span> Step 1: Generate an SSH Key Pair on Your Local Machine</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li>Use the command <code>ssh-keygen -t rsa -b 4096</code> to generate a new SSH key pair.</li>
<li>When prompted, choose the location to save the key. The default path is <code>~/.ssh/id_rsa</code>.</li>
<li>You may opt to enter a passphrase to secure the key or leave it empty for simpler access.</li>
</ul>
</div>
</div>

<div id="outline-container-orgfc69680" class="outline-3">
<h3 id="orgfc69680"><span class="section-number-3">1.2.</span> Step 2: Copy the Public Key to Your Server</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>To enable passwordless login, copy your public key to the server using:
<code>ssh-copy-id your_username@server_address</code></li>
<li>Replace <code>your_username</code> with your server’s username and <code>server_address</code> with the server's IP or domain.</li>
</ul>
</div>
</div>

<div id="outline-container-org41454c9" class="outline-3">
<h3 id="org41454c9"><span class="section-number-3">1.3.</span> Step 3: Log In Without a Password</h3>
<div class="outline-text-3" id="text-1-3">
<ul class="org-ul">
<li>After setting up, log in to the server without a password using:
<code>ssh your_username@server_address</code></li>
</ul>
</div>
</div>

<div id="outline-container-org584194f" class="outline-3">
<h3 id="org584194f"><span class="section-number-3">1.4.</span> Step 4: Troubleshooting</h3>
<div class="outline-text-3" id="text-1-4">
<ul class="org-ul">
<li><b><b>Permissions</b></b>: Ensure that the <code>~/.ssh</code> directory has <code>700</code> permissions and <code>~/.ssh/authorized_keys</code> has <code>600</code> permissions on the server.</li>
<li><b><b>Server Configuration</b></b>: Verify that <code>PubkeyAuthentication</code> is set to <code>yes</code> in the SSH configuration file on the server (<code>/etc/ssh/sshd_config</code>).</li>
</ul>
</div>
</div>

<div id="outline-container-org06ec2e1" class="outline-3">
<h3 id="org06ec2e1"><span class="section-number-3">1.5.</span> Step 5: Using an SSH Agent for Managing Passphrases</h3>
<div class="outline-text-3" id="text-1-5">
<ul class="org-ul">
<li>If your SSH key has a passphrase, you can use an SSH agent to avoid repeated passphrase entry.</li>
<li><p>
Start the SSH agent:
</p>
<div class="org-src-container">
<pre class="src src-shell">     <span style="color: #006FE0;">eval</span> $(<span style="color: #FF1493;">ssh-agent -s</span>)
     ssh-add ~/.ssh/id_rsa
</pre>
</div></li>
</ul>
</div>
</div>

<div id="outline-container-org1f00cbf" class="outline-3">
<h3 id="org1f00cbf"><span class="section-number-3">1.6.</span> Common SSH Commands</h3>
<div class="outline-text-3" id="text-1-6">
<ul class="org-ul">
<li><p>
Here is a list of useful commands for managing SSH keys and connections:
</p>
<div class="org-src-container">
<pre class="src src-shell">     <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Generate a new SSH key if it does not exist</span>
     <span style="color: #006FE0;">cd</span> ~/.ssh
     ssh-keygen -t rsa -b 4096 -C <span style="color: #008000;">"your_email@example.com"</span>

     <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Copy the public key to the server</span>
     ssh-copy-id remote_username@server_ip_address
     <span style="color: #8D8D84;">## </span><span style="color: #8D8D84; font-style: italic;">Once the user is authenticated, the public key will be appended to the remote user authorized_keys file and connection will be closed.</span>

     <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">If ssh-copy-id is unavailable, use this alternative method:</span>
     cat ~/.ssh/id_rsa.pub | ssh remote_username@server_ip_address <span style="color: #008000;">"mkdir -p ~/.ssh &amp;&amp; chmod 700 ~/.ssh &amp;&amp; cat &gt;&gt; ~/.ssh/authorized_keys &amp;&amp; chmod 600 ~/.ssh/authorized_keys"</span>
</pre>
</div></li>

<li>Additional resources: <a href="https://linuxize.com/post/how-to-setup-passwordless-ssh-login">Passwordless SSH Login Guide</a></li>
</ul>
</div>
</div>
</div>


<div id="outline-container-orgf696ebe" class="outline-2">
<h2 id="orgf696ebe"><span class="section-number-2">2.</span> Changing the SSH Key Password</h2>
<div class="outline-text-2" id="text-2">
<p>
If you need to change the passphrase of your SSH key for added security or convenience, follow these steps to update it.
</p>

<ul class="org-ul">
<li><p>
To change the passphrase of your SSH key, use:
</p>
<div class="org-src-container">
<pre class="src src-shell">     ssh-keygen -p -P oldpasswd -N newpassword -f ~/.ssh/id_rsa
</pre>
</div></li>
<li><p>
Alternatively, run interactively:
</p>
<div class="org-src-container">
<pre class="src src-shell">     ssh-keygen -p -f ~/.ssh/id_rsa
</pre>
</div></li>
<li>When prompted, choose a passphrase with at least four characters, which can include words, numbers, and punctuation for stronger security.</li>
</ul>
</div>
</div>


<div id="outline-container-org8d0ab62" class="outline-2">
<h2 id="org8d0ab62"><span class="section-number-2">3.</span> Using SSH Agent to Manage Passphrase</h2>
<div class="outline-text-2" id="text-3">
<p>
If you used a passphrase when creating your SSH key and want to avoid entering it every time, you can use an SSH agent to manage your keys.
</p>

<ul class="org-ul">
<li><p>
Start the SSH agent and add your key:
</p>
<div class="org-src-container">
<pre class="src src-shell">     <span style="color: #006FE0;">eval</span> $(<span style="color: #FF1493;">ssh-agent -s</span>)
     ssh-add ~/.ssh/id_rsa
</pre>
</div></li>
<li>This enables secure, convenient server access without needing to enter the passphrase every time.</li>
</ul>
</div>
</div>


<div id="outline-container-org009847e" class="outline-2">
<h2 id="org009847e"><span class="section-number-2">4.</span> Automating SSH Key Setup for Multiple Servers Using sshpass</h2>
<div class="outline-text-2" id="text-4">
<p>
When deploying to multiple servers, `sshpass` can automate SSH key setup by bypassing the password entry process for each server.
</p>

<ul class="org-ul">
<li><p>
Use the following command:
</p>
<div class="org-src-container">
<pre class="src src-shell">     sshpass -p <span style="color: #008000;">'your_password_here'</span> ssh-copy-id user@server
</pre>
</div></li>
<li>Clear sensitive commands from history with <code>history -d "line_number"</code>.</li>
<li><p>
For more automation, use `expect` to script interactions:
</p>
<div class="org-src-container">
<pre class="src src-expect">     #!/usr/bin/expect

     set timeout 20
     set password "your_password_here"
     set server "server_address"
     set user "your_username"

     spawn ssh-copy-id $user@$server
     expect "password:"
     send "$password\r"
     expect eof
</pre>
</div></li>
</ul>
</div>
</div>


<div id="outline-container-org4e9e0ec" class="outline-2">
<h2 id="org4e9e0ec"><span class="section-number-2">5.</span> Keeping SSH Sessions Alive</h2>
<div class="outline-text-2" id="text-5">
<p>
If your SSH session disconnects after inactivity, you can configure keep-alive settings to maintain the connection.
</p>

<ul class="org-ul">
<li><p>
To apply keep-alive settings globally for all hosts:
</p>
<div class="org-src-container">
<pre class="src src-shell">     <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Edit SSH config file (~/.ssh/config)</span>
     chmod 600 ~/.ssh/config

     Host remotehost
         HostName remotehost.com
         ServerAliveInterval 240

     <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">To apply keep-alive settings globally for all hosts, use:</span>
     Host *
         ServerAliveInterval 240
</pre>
</div></li>

<li><a href="https://stackoverflow.com/questions/25084288/keep-ssh-session-alive">Further info on keeping SSH sessions alive</a></li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: sbilmis</p>
<p class="date">Created: 2024-11-12 Tue 17:11</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
